<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realtime Chat App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom animations */
        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
        
        .typing-indicator {
            animation: pulse 1.5s infinite;
        }
        
        .message-enter {
            animation: fadeInUp 0.3s ease-out;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Custom scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 3px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body class="bg-gray-100 h-screen flex flex-col">
    <div class="flex flex-col h-full max-w-4xl mx-auto bg-white shadow-lg">
        <!-- Header -->
        <div class="bg-indigo-600 text-white p-4 flex items-center">
            <div class="w-10 h-10 rounded-full overflow-hidden bg-white flex items-center justify-center">
                <img src="https://placehold.co/100" alt="Chat app logo with purple gradient background" class="object-cover">
            </div>
            <div class="ml-3">
                <h1 class="font-bold text-xl">ChatApp</h1>
                <p class="text-xs opacity-80" id="connection-status">Online</p>
            </div>
            <div class="ml-auto flex space-x-2">
                <button class="p-2 rounded-full hover:bg-indigo-700 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" />
                    </svg>
                </button>
            </div>
        </div>

        <!-- Chat Area -->
        <div id="chat-area" class="flex-1 overflow-y-auto p-4 custom-scrollbar">
            <!-- Default welcome message -->
            <div class="flex justify-center mb-4">
                <div class="bg-gray-100 rounded-lg py-2 px-4 text-sm text-gray-600">
                    <p>Today at <span id="current-time">11:45 AM</span></p>
                </div>
            </div>
            
            <div class="flex items-start mb-4">
                <div class="w-8 h-8 rounded-full overflow-hidden bg-gray-200 flex-shrink-0">
                    <img src="https://placehold.co/100" alt="Avatar of support agent Alex with friendly smile" class="object-cover">
                </div>
                <div class="ml-3">
                    <div class="bg-gray-200 rounded-lg py-2 px-3">
                        <p class="text-sm">Hello! Welcome to ChatApp. How can I help you today?</p>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">Alex, 11:45 AM</p>
                </div>
            </div>
            
            <!-- Messages will be dynamically added here -->
        </div>

        <!-- Typing Indicator -->
        <div id="typing-indicator" class="hidden px-4 py-2">
            <div class="flex items-center">
                <div class="w-8 h-8 rounded-full overflow-hidden bg-gray-200 flex-shrink-0">
                    <img src="https://placehold.co/100" alt="Other user typing indicator" class="object-cover">
                </div>
                <div class="ml-3 flex space-x-1">
                    <div class="typing-indicator w-2 h-2 bg-gray-400 rounded-full"></div>
                    <div class="typing-indicator w-2 h-2 bg-gray-400 rounded-full delay-100"></div>
                    <div class="typing-indicator w-2 h-2 bg-gray-400 rounded-full delay-200"></div>
                </div>
            </div>
        </div>

        <!-- Input Area -->
        <div class="border-t border-gray-200 p-3">
            <div class="flex items-center bg-gray-100 rounded-lg px-3 py-2">
                <button class="text-gray-500 hover:text-gray-700 mr-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" />
                    </svg>
                </button>
                <input id="message-input" type="text" placeholder="Type your message..." class="flex-1 bg-transparent outline-none text-gray-700">
                <button class="text-gray-500 hover:text-gray-700 ml-2" id="send-button">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Update current time
            function updateTime() {
                const now = new Date();
                const hours = now.getHours();
                const minutes = now.getMinutes();
                const ampm = hours >= 12 ? 'PM' : 'AM';
                const formattedHours = hours % 12 || 12;
                const formattedMinutes = minutes < 10 ? '0' + minutes : minutes;
                document.getElementById('current-time').textContent = `${formattedHours}:${formattedMinutes} ${ampm}`;
            }
            updateTime();
            setInterval(updateTime, 60000); // Update every minute
            
            // DOM elements
            const chatArea = document.getElementById('chat-area');
            const messageInput = document.getElementById('message-input');
            const sendButton = document.getElementById('send-button');
            const typingIndicator = document.getElementById('typing-indicator');
            
            // Sample user data
            const currentUser = {
                id: 'user1',
                name: 'You',
                avatar: 'https://placehold.co/100',
                color: 'bg-indigo-500'
            };
            
            const otherUser = {
                id: 'user2',
                name: 'Alex',
                avatar: 'https://placehold.co/100',
                color: 'bg-gray-200'
            };
            
            // Simulate typing indicator
            let typingTimeout;
            
            messageInput.addEventListener('input', () => {
                clearTimeout(typingTimeout);
                if (messageInput.value.length > 0) {
                    // In a real app, you would send a typing event to the server
                    console.log('User is typing...');
                    
                    typingTimeout = setTimeout(() => {
                        // In a real app, you would send a stopped typing event
                        console.log('User stopped typing');
                    }, 3000);
                }
            });
            
            // Simulate receiving a message (for demo purposes)
            function simulateReply() {
                if (Math.random() > 0.3) { // 70% chance of reply
                    setTimeout(() => {
                        typingIndicator.classList.remove('hidden');
                        
                        setTimeout(() => {
                            typingIndicator.classList.add('hidden');
                            addMessage({
                                user: otherUser,
                                text: getRandomReply(),
                                timestamp: new Date()
                            });
                        }, 1500 + Math.random() * 2000);
                    }, 500 + Math.random() * 2000);
                }
            }
            
            function getRandomReply() {
                const replies = [
                    "That's interesting! Tell me more.",
                    "I see what you mean.",
                    "Let me think about that for a moment...",
                    "That makes sense!",
                    "I hadn't considered that before.",
                    "What else would you like to discuss?",
                    "I'm glad you mentioned that.",
                    "That's a good point.",
                    "I agree with you on that.",
                    "Can you elaborate on that?"
                ];
                return replies[Math.floor(Math.random() * replies.length)];
            }
            
            // Add a message to the chat
            function addMessage({user, text, timestamp}) {
                const isCurrentUser = user.id === currentUser.id;
                
                const formattedTime = formatTime(timestamp);
                
                const messageElement = document.createElement('div');
                messageElement.className = `flex items-start mb-4 ${isCurrentUser ? 'justify-end' : ''} message-enter`;
                
                if (!isCurrentUser) {
                    messageElement.innerHTML = `
                        <div class="w-8 h-8 rounded-full overflow-hidden bg-gray-200 flex-shrink-0">
                            <img src="${user.avatar}" alt="Avatar of ${user.name}" class="object-cover">
                        </div>
                        <div class="ml-3">
                            <div class="${user.color} rounded-lg py-2 px-3 text-white">
                                <p class="text-sm">${text}</p>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">${user.name}, ${formattedTime}</p>
                        </div>
                    `;
                } else {
                    messageElement.innerHTML = `
                        <div class="mr-3">
                            <div class="bg-indigo-500 rounded-lg py-2 px-3 text-white">
                                <p class="text-sm">${text}</p>
                            </div>
                            <p class="text-xs text-gray-500 mt-1 text-right">${formattedTime}</p>
                        </div>
                        <div class="w-8 h-8 rounded-full overflow-hidden bg-indigo-500 flex-shrink-0">
                            <img src="${user.avatar}" alt="Your avatar" class="object-cover">
                        </div>
                    `;
                }
                
                chatArea.appendChild(messageElement);
                chatArea.scrollTop = chatArea.scrollHeight;
            }
            
            // Format time as HH:MM AM/PM
            function formatTime(date) {
                let hours = date.getHours();
                let minutes = date.getMinutes();
                const ampm = hours >= 12 ? 'PM' : 'AM';
                hours = hours % 12;
                hours = hours ? hours : 12; // the hour '0' should be '12'
                minutes = minutes < 10 ? '0'+minutes : minutes;
                return `${hours}:${minutes} ${ampm}`;
            }
            
            // Send message
            function sendMessage() {
                const text = messageInput.value.trim();
                if (text) {
                    addMessage({
                        user: currentUser,
                        text: text,
                        timestamp: new Date()
                    });
                    
                    messageInput.value = '';
                    
                    // Simulate a reply
                    simulateReply();
                }
            }
            
            // Event listeners
            sendButton.addEventListener('click', sendMessage);
            
            messageInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            // Connection status simulation
            let isOnline = true;
            setInterval(() => {
                if (Math.random() > 0.95) { // 5% chance of connection change
                    isOnline = !isOnline;
                    document.getElementById('connection-status').textContent = isOnline ? 'Online' : 'Offline - attempting to reconnect...';
                    document.getElementById('connection-status').className = isOnline ? 'text-xs opacity-80' : 'text-xs opacity-80 text-yellow-500';
                }
            }, 5000);
        });
    </script>
</body>
</html>
